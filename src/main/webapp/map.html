<!DOCTYPE html>
<html>
<head>
  <title>Maps</title>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/map.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCgr6Zutm1Os7q9V5Fi9N_g2poKcDG2G0A">
    </script> 
    
    <script>
      var map;
      var markers = [];
      var count = 0;

      //uses window.setTimeout() to drop markers consecutively
      function addMarkerWithTimeout(position, timeout) {
        window.setTimeout(function() {
          markers.push(new google.maps.Marker({
            position: position,
            map: map,
            animation: google.maps.Animation.DROP
          }));
        }, timeout);
      }

      //initializes the map with specified center and zoom
      function createRestaurantsMap(){
        fetch('/Restaurants').then(function(response) {
          return response.json();
        }).then((FamousRestaurants) => {
          var prev_infowindow = false;

            map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 33.4774, lng: -81.97},
            zoom: 7
          });
          FamousRestaurants.forEach((FamousRestaurant) => {
             const marker = new google.maps.Marker({
              position: {lat: FamousRestaurant.lat, lng: FamousRestaurant.lng},
              map: map
            });
             var infoWindow = new google.maps.InfoWindow({
              content: FamousRestaurant.state
             });
             marker.addListener('click', function() {
              //prevents multiple infowindows from being open at the same time
              if (prev_infowindow) {
                prev_infowindow.close();
              }
              prev_infowindow = infoWindow;
              infoWindow.open(map, marker);
             });
          });
        });
      }

    </script>
</head>

<body onload="createRestaurantsMap();">
 <h1>Best Restaurants in Cities Globally</h1>
 <div id="map"></div>
</body>
</html>


